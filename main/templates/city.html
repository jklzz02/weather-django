{% extends "layout.html" %}
{% load static %}
{% block title %}
{% if not error %}
 {{city}}
{% else %}
 Not Found
{% endif %}
{% endblock title %}

{% block content %}

{% if city_info and not error %}


<article class="city-query-container">

    <section class="city-query-box">

        <header>
          <h2>{{city_info.name}}</h2>
        </header>
        <time class="date" datetime="{{date}}">{{date}}</time>

        <section>
            <strong style="font-size: 46px;"> {{city_info.main.temp|floatformat:"0"}}°C</strong>
            {% for item in city_info.weather %}
            <figure class="info-container">
              <img src="https://openweathermap.org/img/wn/{{item.icon}}@2x.png" alt="{{item.description}}">
              <figcaption>{{item.description}} </figcaption>
            </figure>
            {% endfor %}
        </section>

        <footer class="query-infos">
          <p>Umidità {{city_info.main.humidity}}%</p>
          <p>Vento {{city_info.wind.speed}} m/s</p>
        </footer>

    </section>

  {% if air_conditions and not error%}
  
   <section class="air_conditions-box">
    <h2 class="{{air_conditions.aqi_color}}">{{air_conditions.category}}</h2>
    <h3>Indice di AQI {{air_conditions.aqi}}</h3>
    <p>Contaminante principale: {{air_conditions.dominant_pollutant}}</p>
    {% for pollutant in air_conditions.pollutants %}
    <h3>{{pollutant.fullName}}</h3>
    <p>{{pollutant.displayName}} {{pollutant.concentration.value}}</p>
    {% endfor %}
   </section>
  {% endif %}

  <iframe
  referrerpolicy="no-referrer-when-downgrade"
  src="https://www.google.com/maps/embed/v1/place?key={{map_key}}&q={{city_info.name}}"
  allowfullscreen>
  </iframe>
</article>


<section id="hour-container">
  <div id="hour-box">
  
  {% for item in hourly_forecast %}
  <ul class="hour-list">
    <li><h2>{{item.hour}}</h2></li>
    <li><strong>{{item.temp|floatformat:"0"}}°C</strong></li>
    <li><img class="hour-icon" src="https://openweathermap.org/img/wn/{{item.icon}}@2x.png" alt="{{item.description}}" title="{{item.description}}"></li>
    <li>{{item.description}}</li>
  </ul>
  {% endfor %}

  </div>
</section>

{% else %}
<div class="error-box">
  <h2>città - {{ city }} - non trovata</h2>
  <img class="error-icon" src="{% static "img/not-found.png" %}" alr="city not found">
</div>
{% endif %}

{% if forecast_info %}

<section class="forecast-container">
{% for day in forecast_info %}
<article class="forecast-box">
  <header>
    <h2>{{city_info.name}}</h2>
    <time  class="date" datetime="{{day.forecast_date}}"><span>{{day.forecast_date}}</span></time>
  </header>
  <section>
    <strong>Temperatura</strong>
    <ul>
      <li>mattina    {{day.temp.day|floatformat:"0"}}°C</li>
      <li>pomeriggio {{day.temp.eve|floatformat:"0"}}°C</li>
      <li>sera       {{day.temp.night|floatformat:"0"}}°C</li>
    </ul>
  </section>
  <section>
    <p class="summary">{{day.summary}}</p>
  </section>
    {% for info in day.weather %}
    <figure class="info-container">
      <img src="https://openweathermap.org/img/wn/{{info.icon}}@2x.png" alt="{{info.description}}">
      <figcaption>{{info.description}} </figcaption>
    </figure>
    <aside>
      <span>Umidità {{day.humidity}}%</span>
      <span>Vento {{day.wind}} m/s</span>
    </aside>
    {% endfor %}
  {% if forecast_info.alert %}
    <p>{{forecast_info.alert}}</p>
  {% endif %}
</article>

{% endfor %}
</section>

{% if alert %}


<section class="alert-container">
  <h3 class="alert">{{alert|safe}}</h3>
</section>

{% endif %}
{% endif %}

{% endblock content %}